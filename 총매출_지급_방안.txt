# 총매출 지급 방안

## 1. 기본 원칙
- **매출 발생월**: N월에 발생한 매출
- **지급 시작**: N+1월부터 시작
- **지급 기간**: 10주에 걸쳐 분할 지급
- **지급 단위**: 주차별 지급 (매주 1회씩 총 10회)

## 2. 지급 구조

### 2.1 매출과 지급의 관계
```
N월 매출 → (N+1)월부터 10주간 지급
- 1회차: (N+1)월 1주차
- 2회차: (N+1)월 2주차
- 3회차: (N+1)월 3주차
- 4회차: (N+1)월 4주차
- 5회차: (N+2)월 1주차 (다음 달로 넘어감)
- 6회차: (N+2)월 2주차
- 7회차: (N+2)월 3주차
- 8회차: (N+2)월 4주차
- 9회차: (N+3)월 1주차
- 10회차: (N+3)월 2주차
```

### 2.2 주차별 지급액 계산
각 주차의 지급액은 여러 달 매출의 분할금 합계로 구성됨

**예시: 10월 1주차 지급액**
```
= 7월 매출의 7회차 (8월 1-4회, 9월 5-6회 지급 후)
+ 8월 매출의 3회차 (9월 1-2회 지급 후)
+ 9월 매출의 1회차 (첫 지급)
```

## 3. 실제 적용 예시

### 3.1 월별 매출 가정
- 7월 매출: 1,000만원 (100만원 × 10회)
- 8월 매출: 1,500만원 (150만원 × 10회)
- 9월 매출: 2,000만원 (200만원 × 10회)

### 3.2 10월 지급 상세
```
10월 1주차: 100만원(7월 7회) + 150만원(8월 3회) + 200만원(9월 1회) = 450만원
10월 2주차: 100만원(7월 8회) + 150만원(8월 4회) + 200만원(9월 2회) = 450만원
10월 3주차: 100만원(7월 9회) + 150만원(8월 5회) + 200만원(9월 3회) = 450만원
10월 4주차: 100만원(7월 10회) + 150만원(8월 6회) + 200만원(9월 4회) = 450만원
```

## 4. 시스템 구현 고려사항

### 4.1 데이터 구조
- **매출 테이블**: 매출 발생월, 총 매출액, 분할 금액
- **지급 스케줄**: 매출ID, 회차(1-10), 지급 예정일(년/월/주차), 지급 상태
- **실제 지급**: 지급일, 사용자별 지급액, 원천징수, 실지급액

### 4.2 계산 로직
1. 특정 주차의 지급액 계산시
2. 해당 주차에 지급되어야 할 모든 매출 분할금 조회
3. 각 매출의 해당 회차 금액 합산
4. 사용자별 배분 계산 (등급별 수수료 적용)

### 4.3 주의사항
- 한 달은 최대 5주차까지 존재
- 5주차가 있는 경우 다음 달 이동 시점 조정 필요
- 매출이 없는 달도 이전 매출의 분할 지급은 계속됨

## 5. 화면 표시 방식

### 5.1 지급일 조회
- 특정 날짜에 지급된 실제 내역 표시

### 5.2 기간 조회 - 주간
- 선택 기간의 각 주차별 지급액 표시
- 각 주차마다 여러 매출원의 분할금 합계 표시

### 5.3 기간 조회 - 월간
- 선택 기간의 월별 총 지급액 표시
- 해당 월의 모든 주차 지급액 합계

## 6. 원천징수 및 실지급액
- 지급액의 3.3% 원천징수
- 실지급액 = 지급액 - 원천징수액
- 사용자별 등급에 따른 수수료율 차등 적용 가능

## 7. 월별 매출과 등급 고정 원칙

### 7.1 등급 고정 원칙
**매출 발생 시점의 등급으로 지급액 확정**
- 매출이 발생한 달의 등급을 기준으로 개인별 지급액 계산
- 계산된 지급액은 10회 분할 지급 기간 동안 변경 없음
- 이후 등급이 변동되어도 기존 매출의 분할 지급액은 고정

### 7.2 지급 대상 제한
**매출 발생 시점의 인원만 지급 대상**
- 해당 월에 존재했던 사용자만 그 달 매출의 분할 지급 대상
- 이후 신규 가입자는 이전 매출의 분할 지급 대상에서 제외
- 각 월별 매출은 독립적으로 관리

### 7.3 실제 적용 예시

**8월 시나리오:**
```
8월 현황:
- 총 인원: 64명 (F1: 51명, F2: 5명, F3: 8명)
- 8월 매출: 640,000,000원
- 8월 등급 기준 지급액 확정:
  * F1 등급자: 274,285원/회 × 10회
  * F2 등급자: 1,209,669원/회 × 10회
  * F3 등급자: 2,329,669원/회 × 10회
```

**9월 변동 상황:**
```
9월 변동사항:
- 김철수: F1 → F2 승급
- 신규 가입: 10명 추가

적용 방식:
- 김철수의 8월 매출 분할금: F1 금액(274,285원) 유지
- 김철수의 9월 매출 분할금: F2 금액으로 새로 계산
- 9월 신규 가입자: 8월 매출 분할 지급 대상 아님
- 9월 신규 가입자: 9월 매출부터 분할 지급 대상
```

### 7.4 시스템 구현 요구사항

**데이터 저장 구조:**
1. 매출 발생 시점에 개인별 지급 계획 확정 및 저장
2. 사용자별 지급 스케줄 테이블 구성:
   - 매출월
   - 사용자ID
   - 당시 등급
   - 회차별 지급액
   - 지급 상태

**계산 프로세스:**
1. 매월 말 매출 집계
2. 현재 활성 사용자의 등급별 분포 확인
3. 등급별 지급액 계산 및 확정
4. 10회차 지급 스케줄 생성
5. 이후 등급 변동과 관계없이 확정된 금액으로 지급

### 7.5 원칙의 목적
- **공정성**: 매출 기여 시점의 등급을 정확히 반영
- **예측가능성**: 지급액이 확정되어 수익 예측 가능
- **투명성**: 등급 변동에 따른 소급 적용 없음
- **동기부여**: 등급 상승 시 다음 매출부터 혜택 적용
   