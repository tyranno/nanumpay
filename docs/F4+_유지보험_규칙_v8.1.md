# F4+ 유지보험 규칙 (v8.1)

**작성일**: 2025-12-09
**상태**: 설계 확정

---

## 1. 등급별 기본 정보

| 등급 | 최대 횟수 | 기본지급 | 추가지급 차수 |     유지보험 조건     |
| :--: | :-------: | :------: | :-----------: | :-------------------: |
|  F1  |   20회   |   10회   |    1차까지    |           -           |
|  F2  |   30회   |   10회   |    2차까지    |           -           |
|  F3  |   40회   |   10회   |    3차까지    |           -           |
|  F4  |   40회   |   10회   |    3차까지    | **7만원 이상** |
|  F5  |   50회   |   10회   |    4차까지    | **7만원 이상** |
|  F6  |   50회   |   10회   |    4차까지    | **9만원 이상** |
|  F7  |   60회   |   10회   |    5차까지    | **9만원 이상** |
|  F8  |   60회   |   10회   |    5차까지    | **11만원 이상** |

---

## 2. 유지보험 3대 규칙

### 2.1 유예기간

| 항목                     | 내용                                                   |
| ------------------------ | ------------------------------------------------------ |
| **적용 등급**      | F4 이상                                                |
| **기본지급 시작**  | 승급 후**1달 뒤** (달력상 다음달 같은 날)        |
| **유예 기간**      | 기본지급 시작 후**한달** (달력상 다음달 같은 날) |
| **보험 체크 시작** | 승급 후 약**2달 뒤**                             |
| **유예 기간 중**   | 보험 없어도**정상 지급**                         |
| **유예 기간 후**   | 보험 체크 시작 → 미가입 시**지급 정지**         |
| **보험 해지 시**   | **다음 금요일부터 정지**                         |

```
┌─────────────────────────────────────────────────────────────┐
│  F4 승급 (10월 말)                                           │
│    ↓                                                        │
│  [1달 대기] - 11월                                           │
│    - 기본지급 시작 전                                         │
│    ↓                                                        │
│  [기본지급 시작] - 12월 초                                    │
│    ↓                                                        │
│  [유예기간 - 한달] - 12월                                     │
│    - 1주차: 지급 ✓ (보험 무관)                                 │
│    - 2주차: 지급 ✓ (보험 무관)                                 │
│    - 3주차: 지급 ✓ (보험 무관)                                 │
│    - 4주차: 지급 ✓ (보험 무관)                                 │
│    ↓                                                        │
│  [유예기간 종료] - 1월 초 (승급 후 약 2달)                      │
│    - 보험 있음 → 정상 지급 계속                                │
│    - 보험 없음 → 지급 정지 시작                                │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 유지보험 조건

| 등급 | 최소 금액 |      비고      |
| :--: | :-------: | :------------: |
|  F1  |     -     | 보험 조건 없음 |
|  F2  |     -     | 보험 조건 없음 |
|  F3  |     -     | 보험 조건 없음 |
|  F4  |   7만원   |                |
|  F5  |   7만원   |   F4와 동일   |
|  F6  |   9만원   |                |
|  F7  |   9만원   |   F6와 동일   |
|  F8  |  11만원  |   최고 등급   |

### 2.3 승계조건

| 항목                     | 내용                                               |
| ------------------------ | -------------------------------------------------- |
| **승계 가능 범위** | **1단계 상위 등급만** (F5→F6 ○, F5→F7 ✗) |
| **승계 가능 시점** | 하위 등급의**모든 지급 완료 전** 승급 시     |
| **승계 인정 시**   | 상위 등급 보험 기준**면제** (기존 금액 유지) |
| **승계 불가 시**   | 상위 등급 보험 기준**새로 충족** 필요        |

```
┌─────────────────────────────────────────────────────────────┐
│  승계 예시: F5 → F6                                          │
│                                                             │
│  [승계 가능한 경우]                                           │
│    - F5에서 7만원 보험 유지 중                                 │
│    - F5 지급 완료 전 F6 승급                                   │
│    → F6 기준 9만원 필요하지만 7만원으로 OK!                      │
│                                                             │
│  [승계 불가한 경우]                                           │
│    - F5 모든 지급 완료 후 F6 승급                              │
│    → F6 기준 9만원 새로 충족 필요                              │
│    → 미충족 시 유예기간 후 지급 정지                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 승계 가능 매트릭스

|  승급  | 원래 필요 |     승계 시     |               승계 효과               |
| :----: | :-------: | :-------------: | :-----------------------------------: |
| F3→F4 |   7만원   |        -        |           (F3는 조건 없음)           |
| F4→F5 |   7만원   |      7만원      |           동일 (효과 없음)           |
| F5→F6 |   9만원   | **7만원** | **F5 금액으로 유지 보험 인정** |
| F6→F7 |   9만원   |      9만원      |           동일 (효과 없음)           |
| F7→F8 |  11만원  | **9만원** | **F7 금액으로 유지 보험 인정** |

---

## 4. 등급별 지급 기간 (병행 시)

추가지급이 순차적으로 시작되지만 병행 진행되므로 실제 기간은 단축됨:

| 등급 | 추가 차수 | 순차 시 | 병행 시 (예상) |
| :--: | :-------: | :-----: | :------------: |
|  F1  |    1차    |  20주  |     ~13주     |
|  F2  |    2차    |  30주  |     ~18주     |
|  F3  |    3차    |  40주  |     ~22주     |
|  F4  |    3차    |  40주  |     ~22주     |
|  F5  |    4차    |  50주  |     ~26주     |
|  F6  |    4차    |  50주  |     ~26주     |
|  F7  |    5차    |  60주  |     ~30주     |
|  F8  |    5차    |  60주  |     ~30주     |

```
예시: F4 (기본 + 추가 3차)

주차:  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
      ├────────── 기본 10회 ──────────┤
                        ├────────── 추가1 10회 ──────────┤
                              ├────────── 추가2 10회 ──────────┤
                                    ├────────── 추가3 10회 ──────────┤
                                                                   ↑
                                                          약 22주에 완료
```

---

## 5. 지급 상태 흐름도

### 5.1 F4+ 신규 승급 시

```
┌─────────────────────────────────────────────────────────────┐
│                      F4+ 승급                                │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  [1달 대기]                                                   │
│    - 기본지급 시작 전                                          │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  [기본지급 시작] - 보험 무관하게 시작!                          │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  [유예기간 - 한달]                                            │
│    - 보험 없어도 정상 지급                                     │
└─────────────────────────────────────────────────────────────┘
                            ↓
                ┌───────────┴───────────┐
                ↓                       ↓
┌───────────────────────┐   ┌───────────────────────┐
│  유예기간 내 보험 가입  │   │  유예기간 후에도 미가입  │
│    → 정상 지급 계속    │   │    → 지급 정지        │
└───────────────────────┘   └───────────────────────┘
                                        ↓
                            ┌───────────┴───────────┐
                            ↓                       ↓
                ┌───────────────────────┐   ┌───────────────────────┐
                │  이후 보험 가입        │   │  끝까지 미가입         │
                │    → 가입 후 정상 지급 │   │    → 계속 정지        │
                │    (정지분 = 손실)     │   │    (추가지급 불가)     │
                └───────────────────────┘   └───────────────────────┘
```

### 5.2 승계 포함 흐름

```
┌─────────────────────────────────────────────────────────────┐
│  F5 → F6 승급                                                │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│  [승계 조건 체크]                                             │
│    - 1단계 상위인가? (F5→F6 = 1단계 ✓)                        │
│    - F5 지급 완료 전인가?                                     │
└─────────────────────────────────────────────────────────────┘
                            ↓
                ┌───────────┴───────────┐
                ↓                       ↓
┌───────────────────────┐   ┌───────────────────────┐
│  승계 인정             │   │  승계 불가             │
│  (F5 완료 전 승급)     │   │  (F5 완료 후 승급)     │
└───────────────────────┘   └───────────────────────┘
        ↓                               ↓
┌───────────────────────┐   ┌───────────────────────┐
│  F6 보험 기준 면제     │   │  F6 보험 기준 적용     │
│  → 기존 7만원으로 OK   │   │  → 9만원 새로 필요     │
└───────────────────────┘   └───────────────────────┘
        ↓                               ↓
┌───────────────────────┐   ┌───────────────────────┐
│  F6 기본지급 시작      │   │  [유예기간 - 한달]     │
│  (유예기간 없음!)      │   │  → 9만원 미충족 시     │
│  → 바로 정상 지급     │   │  → 지급 정지           │
└───────────────────────┘   └───────────────────────┘
```

---

## 6. 예시 시나리오

### 6.1 정상 케이스: 유예기간 내 보험 가입

| 시점 | 날짜 | 이벤트                    | 지급 상태 |
| :--: | :---: | :------------------------ | :-------: |
|  -  | 10/31 | **F4 승급**         |     -     |
|  -  | 11월 | [1달 대기]                |     -     |
| 1주 | 12/5 | **기본지급 시작**   |  ✓ 지급  |
| 2주 | 12/12 | **7만원 보험 가입** |  ✓ 지급  |
| 3주 | 12/19 |                           |  ✓ 지급  |
| 4주 | 12/26 |                           |  ✓ 지급  |
| 5주 |  1/2  | 유예기간 종료             |  ✓ 지급  |
| 6주 |  1/9  |                           |  ✓ 지급  |
| ... |  ...  |                           |  ✓ 지급  |

### 6.2 지연 케이스: 유예기간 이후 보험 가입

| 시점 | 날짜 | 이벤트                    |    지급 상태    |
| :--: | :---: | :------------------------ | :--------------: |
|  -  | 10/31 | **F4 승급**         |        -        |
|  -  | 11월 | [1달 대기]                |        -        |
| 1주 | 12/5 | **기본지급 시작**   |     ✓ 지급     |
| 2주 | 12/12 |                           |     ✓ 지급     |
| 3주 | 12/19 |                           |     ✓ 지급     |
| 4주 | 12/26 |                           |     ✓ 지급     |
| 5주 |  1/2  | 유예기간 종료, 보험 없음  | ✗**정지** |
| 6주 |  1/9  | 보험 없음                 | ✗**정지** |
| 7주 | 1/16 | **7만원 보험 가입** |  ✓ 지급 (재개)  |
| 8주 | 1/23 |                           |     ✓ 지급     |
| ... |  ...  |                           |     ✓ 지급     |

> **정지분 (5주, 6주차) = 영구 손실**

### 6.3 승계 케이스: F5 → F6

| 주차 | 날짜 | 이벤트                | 지급 상태 |
| :--: | :--: | :-------------------- | :-------: |
|  1  | 11/7 | F5 승급, 7만원 보험   |  ✓ 지급  |
| ... | ... | F5 지급 진행 중       |  ✓ 지급  |
|  15  | 2/14 | F6 승급 (F5 완료 전)  |          |
|      |      | →**승계 인정** |          |
|      |      | → F6도 7만원으로 OK  |  ✓ 지급  |
|      |      | → 유예기간 없음!     |          |
|  16  | 2/21 |                       |  ✓ 지급  |
| ... | ... |                       |  ✓ 지급  |

### 6.4 보험 해지 케이스

| 주차 | 날짜 | 이벤트                         |    지급 상태    |
| :--: | :--: | :----------------------------- | :--------------: |
|  10  | 1/10 | 정상 지급 중                   |     ✓ 지급     |
|  11  | 1/17 | 정상 지급                      |     ✓ 지급     |
|  12  | 1/20 | **보험 해지** (화요일)   |        -        |
|  13  | 1/24 | **다음 금요일부터 정지** | ✗**정지** |
|  14  | 1/31 | 보험 없음                      | ✗**정지** |
|  15  | 2/5 | **7만원 보험 재가입**    |  ✓ 지급 (재개)  |
|  16  | 2/12 |                                |     ✓ 지급     |

> **보험 해지 시점과 무관하게 다음 금요일부터 정지**

---

## 7. 데이터 모델 변경

### 7.1 User 모델

**변경 없음** - 기존 필드 그대로 사용

```javascript
{
  insuranceActive: Boolean,     // 보험 활성 여부
  insuranceAmount: Number,      // 보험 금액
  insuranceDate: Date           // 보험 가입일
}
```

### 7.2 WeeklyPaymentPlans 추가 필드

계획 생성 시점에 보험 조건 결정 → 보험 변경 시 installment 상태 업데이트

```javascript
{
  // 기존 필드
  baseGrade: String,

  // 신규 필드 (F4+ 계획에만 적용)
  graceDeadline: Date,           // 유예기간 마감일 (승급 후 2달)
  insuranceRequired: Number,     // 필요 보험 금액 (승계 시 하위 등급 기준)
  insuranceInherited: Boolean    // 승계 여부
}
```

### 7.3 처리 흐름

```
[계획 생성 시점]
1. 승계 조건 체크
   - 이전 등급 active 계획 존재?
   - 1단계 상위 승급?
2. insuranceRequired 결정
   - 승계 O → 이전 등급 기준 금액
   - 승계 X → 현재 등급 기준 금액
3. graceDeadline 설정
   - 승계 O → null (유예기간 없음)
   - 승계 X → 승급일 + 2달

[보험 변경 시점]
1. User.insuranceAmount 변경 감지
2. 해당 사용자의 active 계획 조회
3. 각 계획의 insuranceRequired와 비교
4. 미충족 + 유예기간 지남 → installment를 skipped로 변경
5. 충족 → skipped를 pending으로 복구 (미래 건만)
```

---

## 8. 확인 완료 사항

| # | 질문                  | 답변                                                         |
| - | --------------------- | ------------------------------------------------------------ |
| 1 | "한달"의 정확한 기준? | **달력상 다음달 같은 날** (10/10→11/10, 10/15→11/15) |
| 2 | 승계 시 유예기간?     | **유예기간 없음** - 이전 요건으로 승계되어 바로 인정   |
| 3 | 보험 해지 시?         | **다음 금요일부터 정지**                               |
| 4 | F3→F4 승급 시?       | **F4 기준 적용** - F4부터 유지보험 규칙 시작           |

---

## 변경 이력

| 버전 | 날짜       | 내용                                        |
| ---- | ---------- | ------------------------------------------- |
| v8.1 | 2025-12-09 | F4+ 유지보험 규칙 신규 설계                 |
|      |            | - 유예기간: 달력상 다음달 같은 날 기준 확정 |
|      |            | - 승계 시 유예기간 없음 확정                |
|      |            | - 보험 해지 시 다음 금요일부터 정지 확정    |
|      |            | - 보험 해지 시나리오 추가                   |
