# 중간 승급 지급계획 수정 결과 점검

**작성일**: 2026-01-15
**수정 커밋**: `64cd698 fix: 중간 승급 지급 계획 누락 버그 수정`

---

## 1. 문제 현상

중간 승급이 발생한 경우(예: F1→F3→F4) 마지막 승급(F4)에 대한 지급계획만 생성되고, 중간 승급(F3)에 대한 지급계획이 누락됨.

### 원인
`step4_createPlans.js` 4-2 섹션에서 승급 기록 중 마지막 것만 사용:
```javascript
// 수정 전 (버그)
const promotionHistory = promotionHistories[promotionHistories.length - 1];
```

### 해결
모든 승급 기록에 대해 지급계획 생성하도록 수정:
```javascript
// 수정 후
for (const promotionHistory of promotionHistories) {
  // 각 승급마다 지급계획 생성
}
```

---

## 2. 중간 승급자 현황 (6명)

### 2.1 김진숙3

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F3 | 2025-12-15 | 2025-12 | 2026-01-16 | terminated |
| 승급2 | F3→F4 | 2025-12-28 | 2025-12 | 2026-01-30 | active |

---

### 2.2 박세환1

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F3 | 2025-10-27 | 2025-10 | 2025-11-28 | terminated |
| 추가 | F3 | - | 2025-11 | 2026-01-02 | terminated |
| 승급2 | F3→F4 | 2025-12-08 | 2025-12 | 2026-01-09 | terminated |
| 승급3 | F4→F5 | 2025-12-15 | 2025-12 | 2026-01-16 | active |

---

### 2.3 김보미1

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F4 | 2025-12-08 | 2025-12 | 2026-01-09 | terminated |
| 승급2 | F4→F5 | 2025-12-15 | 2025-12 | 2026-01-16 | active |

---

### 2.4 김보미2

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F2 | 2025-12-01 | 2025-12 | 2026-01-02 | terminated |
| 승급2 | F2→F4 | 2025-12-15 | 2025-12 | 2026-01-16 | active |

---

### 2.5 김소진2

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F2 | 2025-12-08 | 2025-12 | 2026-01-09 | terminated |
| 승급2 | F2→F4 | 2025-12-15 | 2025-12 | 2026-01-16 | active |

---

### 2.6 나오성2

| 구분 | 등급 | 승급일 | 매출월 | 첫지급일 | 상태 |
|------|------|--------|--------|----------|------|
| 승급1 | F1→F2 | 2025-12-15 | 2025-12 | 2026-01-16 | terminated |
| 승급2 | F2→F3 | 2025-12-28 | 2025-12 | 2026-01-30 | active |

---

## 3. 검증 결과

| 항목 | 결과 |
|------|------|
| 중간 승급자 수 | 6명 |
| 중간 승급 지급계획 생성 | ✅ 모두 정상 |
| 후속 승급 시 이전 계획 terminated | ✅ 정상 |
| 최종 승급 계획 active | ✅ 정상 |

---

## 4. 배포 현황

| 환경 | 상태 | 배포일시 |
|------|------|----------|
| 테스트 서버 | ✅ 완료 | 2026-01-15 12:50 |
| 운영 서버 | ⏳ 대기 | - |

---

## 5. 수정 파일

- `apps/web/src/lib/server/services/registration/step4_createPlans.js`
  - 4-2 섹션: 기존 승급자 처리 로직
  - 모든 gradeHistory 승급 기록에 대해 반복 처리하도록 수정
