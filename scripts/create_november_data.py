#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
11ì›” í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- ê¸°ì¡´ 7~10ì›” ë°ì´í„°ì™€ ì—°ê³„
- ì•½ 120ëª… ì¶”ê°€ (ê¸°ì¡´ 160ëª… + 120ëª… = 280ëª…)
- F4 ì´ìƒ ë“±ê¸‰ ë‹¬ì„± ê°€ëŠ¥í•˜ë„ë¡ íŠ¸ë¦¬ êµ¬ì¡° ì„¤ê³„
"""

import openpyxl
from openpyxl.styles import Font, Alignment, PatternFill
from datetime import datetime, timedelta
import random
import os

# ============================================
# ê¸°ì¡´ ì‚¬ìš©ì ëª©ë¡ (7~10ì›”)
# ============================================

# ê¸°ì¡´ ë“±ë¡ìë“¤ (íŒë§¤ì¸ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥)
# âš ï¸ 'ì‚¬ì¥ë‹˜', 'ê¹€ì˜ìˆ˜'ëŠ” íŠ¸ë¦¬ê°€ ê°€ë“ ì°¨ì„œ ë’¤ë¡œ ë°€ìŒ
EXISTING_USERS = [
    # 7ì›” ê°„ë‹¨ (ì‚¬ì¥ë‹˜, ê¹€ì˜ìˆ˜ ì œì™¸ - íŠ¸ë¦¬ í¬í™”)
    'ì´ë¯¸ì˜',
    # 7ì›” ì¶”ê°€
    'ë°•ì² ìˆ˜', 'ë°•ì² ìˆ˜2', 'ë°•ì² ìˆ˜3', 'ë°•ì² ìˆ˜4', 'ê°•ë¯¼ì§€', 'ì´ìˆœì‹ ', 'ê¹€ìœ ì‹ ',
    # 8ì›”
    'í•œì˜ˆì§„', 'í•œì˜ˆì§„2', 'í™©ë¯¼ì •', 'í™©ë¯¼ì •2', 'ì‹ ìœ¤ë³µ', 'ì‹ ìœ¤ë³µ2',
    'ì •ì„ ', 'ì •ì„ 2', 'ë°•ì§€ì›', 'ë°•ì§€ì›2', 'ë°•ì§€ì›3',
    'ìœ¤ì„œì¤€', 'ìœ¤ì„œì¤€2', 'ìœ¤ì„œì¤€3', 'ìœ¤ì„œì¤€4',
    # 9ì›”
    'ìµœë¯¼ìˆ˜', 'ìµœë¯¼ìˆ˜2', 'ìµœë¯¼ìˆ˜3', 'ìµœë¯¼ìˆ˜4', 'ìµœë¯¼ìˆ˜5', 'ìµœë¯¼ìˆ˜6',
    'ì†¡ê°€ì¸', 'ì†¡ê°€ì¸2', 'ì†¡ê°€ì¸3', 'ì†¡ê°€ì¸4', 'ì†¡ê°€ì¸5',
    'ë¥˜í˜„ì§„', 'ë¥˜í˜„ì§„2', 'ë¥˜í˜„ì§„3', 'ë¥˜í˜„ì§„4', 'ë¥˜í˜„ì§„5',
    'ì•ˆì •í™˜', 'ì•ˆì •í™˜2', 'ì•ˆì •í™˜3', 'ì•ˆì •í™˜4', 'ì•ˆì •í™˜5',
    'ë°°ìš©ì¤€', 'ë°°ìš©ì¤€2', 'ë°°ìš©ì¤€3', 'ë°°ìš©ì¤€4',
    'ì „ì§€í˜„', 'ì „ì§€í˜„2', 'ì „ì§€í˜„3', 'ì „ì§€í˜„4',
    'ê³ ì†Œì˜', 'ê³ ì†Œì˜2', 'ê³ ì†Œì˜3', 'ê³ ì†Œì˜4',
    'ê¹€í•˜ëŠ˜', 'ê¹€í•˜ëŠ˜2', 'ê¹€í•˜ëŠ˜3', 'ê¹€í•˜ëŠ˜4',
    'ì´ë‚˜ì˜', 'ì´ë‚˜ì˜2', 'ì´ë‚˜ì˜3', 'ì´ë‚˜ì˜4',
    'í•œì§€ë¯¼', 'í•œì§€ë¯¼2', 'í•œì§€ë¯¼3', 'í•œì§€ë¯¼4',
    # 10ì›”
    'ê¹€íƒœí¬', 'ì •ìš°ì„±', 'ì •ìš°ì„±2', 'ì •ìš°ì„±3', 'ì •ìš°ì„±4', 'ì •ìš°ì„±5',
    'ì†ì˜ˆì§„', 'ì†ì˜ˆì§„2', 'í˜„ë¹ˆ', 'í˜„ë¹ˆ2', 'í˜„ë¹ˆ3', 'í˜„ë¹ˆ4',
    'ì´ë³‘í—Œ', 'ì†¡í˜œêµ', 'ì†¡í˜œêµ2', 'ì†¡í˜œêµ3',
    'ê°•ë™ì›', 'ê°•ë™ì›2', 'ê°•ë™ì›3', 'ê°•ë™ì›4', 'ê°•ë™ì›5', 'ê°•ë™ì›6',
    'ì „ë„ì—°', 'ì „ë„ì—°2', 'í•˜ì •ìš°', 'í•˜ì •ìš°2', 'í•˜ì •ìš°3', 'í•˜ì •ìš°4',
    'ê¹€í˜œìˆ˜', 'ì¡°ì¸ì„±', 'ì¡°ì¸ì„±2', 'ì¡°ì¸ì„±3',
    'ì†¡ê°•í˜¸', 'ì†¡ê°•í˜¸2', 'ì†¡ê°•í˜¸3', 'ì†¡ê°•í˜¸4', 'ì†¡ê°•í˜¸5',
    'ì´ì •ì¬', 'ì´ì •ì¬2', 'ê³µìœ ',
    'ê¹€ìˆ˜í˜„', 'ê¹€ìˆ˜í˜„2', 'ê¹€ìˆ˜í˜„3', 'ê¹€ìˆ˜í˜„4', 'ê¹€ìˆ˜í˜„5', 'ê¹€ìˆ˜í˜„6', 'ê¹€ìˆ˜í˜„7',
    'ë°•ì„œì¤€', 'ë°•ì„œì¤€2', 'ë°•ì„œì¤€3', 'ì´ë¯¼í˜¸', 'ì´ë¯¼í˜¸2',
    'ê¹€ì§€ì›', 'ê¹€ì§€ì›2', 'ê¹€ì§€ì›3', 'ê¹€ì§€ì›4',
    'ë°•ë³´ì˜', 'í•œíš¨ì£¼', 'í•œíš¨ì£¼2', 'í•œíš¨ì£¼3', 'í•œíš¨ì£¼4', 'í•œíš¨ì£¼5',
    'ìˆ˜ì§€', 'ìˆ˜ì§€2', 'ì•„ì´ìœ ', 'ì•„ì´ìœ 2', 'ì•„ì´ìœ 3',
    'ê¹€ê³ ì€', 'ê¹€ê³ ì€2', 'ê¹€ê³ ì€3', 'ê¹€ê³ ì€4',
    'ë°•ì‹ í˜œ', 'ì „ì†Œë¯¼', 'ì „ì†Œë¯¼2', 'ì „ì†Œë¯¼3', 'ì „ì†Œë¯¼4', 'ì „ì†Œë¯¼5', 'ì „ì†Œë¯¼6',
    'ê¹€ë‹¤ë¯¸', 'ê¹€ë‹¤ë¯¸2', 'ì´ì„±ê²½', 'ì´ì„±ê²½2', 'ì´ì„±ê²½3',
    'í•œì†Œí¬', 'í•œì†Œí¬2', 'í•œì†Œí¬3', 'í•œì†Œí¬4',
    'ì •í˜¸ì—°', 'ê¹€ì„¸ì •', 'ê¹€ì„¸ì •2', 'ê¹€ì„¸ì •3', 'ê¹€ì„¸ì •4', 'ê¹€ì„¸ì •5',
]

# ============================================
# 11ì›” ì‹ ê·œ ë°ì´í„° (ì•½ 120ëª…)
# ============================================

NOVEMBER = [
    # 30ê°œ ID, ë‹¤ì–‘í•œ ì¸ì›ìˆ˜ (ì´ ì•½ 120ëª…)
    ('ì´ë„í˜„', ['ì´ë„í˜„', 'ì´ë„í˜„2', 'ì´ë„í˜„3', 'ì´ë„í˜„4', 'ì´ë„í˜„5']),  # 5ëª…
    ('ì°¨ì€ìš°', ['ì°¨ì€ìš°', 'ì°¨ì€ìš°2', 'ì°¨ì€ìš°3']),  # 3ëª…
    ('ì†¡ì¤‘ê¸°', ['ì†¡ì¤‘ê¸°', 'ì†¡ì¤‘ê¸°2', 'ì†¡ì¤‘ê¸°3', 'ì†¡ì¤‘ê¸°4']),  # 4ëª…
    ('ë°•ë³´ê²€', ['ë°•ë³´ê²€', 'ë°•ë³´ê²€2']),  # 2ëª…
    ('ê¹€ì„ í˜¸', ['ê¹€ì„ í˜¸', 'ê¹€ì„ í˜¸2', 'ê¹€ì„ í˜¸3', 'ê¹€ì„ í˜¸4', 'ê¹€ì„ í˜¸5', 'ê¹€ì„ í˜¸6']),  # 6ëª…
    ('ë‚¨ì£¼í˜', ['ë‚¨ì£¼í˜', 'ë‚¨ì£¼í˜2', 'ë‚¨ì£¼í˜3']),  # 3ëª…
    ('ì´ì¢…ì„', ['ì´ì¢…ì„', 'ì´ì¢…ì„2', 'ì´ì¢…ì„3', 'ì´ì¢…ì„4']),  # 4ëª…
    ('ê¹€ìš°ë¹ˆ', ['ê¹€ìš°ë¹ˆ']),  # 1ëª…
    ('ë°•í•´ì§„', ['ë°•í•´ì§„', 'ë°•í•´ì§„2', 'ë°•í•´ì§„3', 'ë°•í•´ì§„4', 'ë°•í•´ì§„5']),  # 5ëª…
    ('ì •í•´ì¸', ['ì •í•´ì¸', 'ì •í•´ì¸2']),  # 2ëª…
    ('ì„œê°•ì¤€', ['ì„œê°•ì¤€', 'ì„œê°•ì¤€2', 'ì„œê°•ì¤€3']),  # 3ëª…
    ('ì•ˆíš¨ì„­', ['ì•ˆíš¨ì„­', 'ì•ˆíš¨ì„­2', 'ì•ˆíš¨ì„­3', 'ì•ˆíš¨ì„­4']),  # 4ëª…
    ('ê¹€ì˜ëŒ€', ['ê¹€ì˜ëŒ€', 'ê¹€ì˜ëŒ€2', 'ê¹€ì˜ëŒ€3', 'ê¹€ì˜ëŒ€4', 'ê¹€ì˜ëŒ€5', 'ê¹€ì˜ëŒ€6', 'ê¹€ì˜ëŒ€7']),  # 7ëª…
    ('í™©ì¸ì—½', ['í™©ì¸ì—½', 'í™©ì¸ì—½2']),  # 2ëª…
    ('ì†¡ê°•', ['ì†¡ê°•', 'ì†¡ê°•2', 'ì†¡ê°•3', 'ì†¡ê°•4']),  # 4ëª…
    ('ë³€ìš°ì„', ['ë³€ìš°ì„', 'ë³€ìš°ì„2', 'ë³€ìš°ì„3', 'ë³€ìš°ì„4', 'ë³€ìš°ì„5']),  # 5ëª…
    ('ìµœìš°ì‹', ['ìµœìš°ì‹', 'ìµœìš°ì‹2', 'ìµœìš°ì‹3']),  # 3ëª…
    ('ë¥˜ì¤€ì—´', ['ë¥˜ì¤€ì—´', 'ë¥˜ì¤€ì—´2']),  # 2ëª…
    ('ë°•ì •ë¯¼', ['ë°•ì •ë¯¼', 'ë°•ì •ë¯¼2', 'ë°•ì •ë¯¼3', 'ë°•ì •ë¯¼4']),  # 4ëª…
    ('ì´ì œí›ˆ', ['ì´ì œí›ˆ']),  # 1ëª…
    ('ìœ ì•„ì¸', ['ìœ ì•„ì¸', 'ìœ ì•„ì¸2', 'ìœ ì•„ì¸3', 'ìœ ì•„ì¸4', 'ìœ ì•„ì¸5', 'ìœ ì•„ì¸6']),  # 6ëª…
    ('ê¹€ë²”', ['ê¹€ë²”', 'ê¹€ë²”2', 'ê¹€ë²”3']),  # 3ëª…
    ('ì´ì¤€ê¸°', ['ì´ì¤€ê¸°', 'ì´ì¤€ê¸°2', 'ì´ì¤€ê¸°3', 'ì´ì¤€ê¸°4']),  # 4ëª…
    ('ì§€ì°½ìš±', ['ì§€ì°½ìš±', 'ì§€ì°½ìš±2']),  # 2ëª…
    ('ì¡°ì •ì„', ['ì¡°ì •ì„', 'ì¡°ì •ì„2', 'ì¡°ì •ì„3', 'ì¡°ì •ì„4', 'ì¡°ì •ì„5']),  # 5ëª…
    ('ìœ ì—°ì„', ['ìœ ì—°ì„', 'ìœ ì—°ì„2', 'ìœ ì—°ì„3']),  # 3ëª…
    ('ì •ê²½í˜¸', ['ì •ê²½í˜¸', 'ì •ê²½í˜¸2', 'ì •ê²½í˜¸3', 'ì •ê²½í˜¸4']),  # 4ëª…
    ('ì´ì„œì§„', ['ì´ì„œì§„', 'ì´ì„œì§„2', 'ì´ì„œì§„3', 'ì´ì„œì§„4', 'ì´ì„œì§„5', 'ì´ì„œì§„6']),  # 6ëª…
    ('ì•ˆì¬í˜„', ['ì•ˆì¬í˜„', 'ì•ˆì¬í˜„2']),  # 2ëª…
    ('ê¹€ë¯¼ì„', ['ê¹€ë¯¼ì„', 'ê¹€ë¯¼ì„2', 'ê¹€ë¯¼ì„3', 'ê¹€ë¯¼ì„4', 'ê¹€ë¯¼ì„5']),  # 5ëª…
]


# ============================================
# í—¬í¼ í•¨ìˆ˜ë“¤
# ============================================

def generate_person_data(name, counter, account_id, salesperson):
    """ê°œì¸ ë°ì´í„° ìë™ ìƒì„±"""
    banks = ['KBêµ­ë¯¼ì€í–‰', 'ì‹ í•œì€í–‰', 'ìš°ë¦¬ì€í–‰', 'í•˜ë‚˜ì€í–‰', 'ë†í˜‘ì€í–‰', 'ê¸°ì—…ì€í–‰', 'NHë†í˜‘ì€í–‰', 'ì¹´ì¹´ì˜¤ë±…í¬', 'í† ìŠ¤ë±…í¬']

    # ì „í™”ë²ˆí˜¸ ìƒì„± (010-XXXX-XXXX í˜•ì‹)
    phone_middle = 3000 + (counter * 7) % 7000
    phone_last = 2000 + (counter * 13) % 8000

    # ì£¼ë¯¼ë²ˆí˜¸ ìƒì„± (YYMMDD-1XXXXXX ë˜ëŠ” YYMMDD-2XXXXXX)
    year = 80 + (counter % 20)  # 80~99 (1980~1999ë…„ìƒ)
    month = 1 + (counter % 12)
    day = 1 + (counter % 28)
    gender = 1 + (counter % 2)  # 1 ë˜ëŠ” 2
    random_digits = 2000000 + (counter * 123456) % 8000000
    id_number = f'{year:02d}{month:02d}{day:02d}-{gender}{random_digits:07d}'[:14]

    # ê³„ì¢Œë²ˆí˜¸ ìƒì„± (ì€í–‰ë³„ ì‹¤ì œ í˜•ì‹)
    bank = banks[counter % len(banks)]
    if 'êµ­ë¯¼' in bank:
        account = f'{200000 + counter:06d}-{10 + counter % 90:02d}-{200000 + counter * 7 % 800000:06d}'
    elif 'ì‹ í•œ' in bank:
        account = f'{200 + counter % 800:03d}-{200 + counter % 800:03d}-{200000 + counter * 3 % 800000:06d}'
    elif 'ìš°ë¦¬' in bank:
        account = f'{2000 + counter % 8000:04d}-{200 + counter % 800:03d}-{200000 + counter * 5 % 800000:06d}'
    elif 'í•˜ë‚˜' in bank:
        account = f'{200 + counter % 800:03d}-{200000 + counter % 800000:06d}-{20000 + counter * 11 % 80000:05d}'
    elif 'ë†í˜‘' in bank:
        account = f'{200 + counter % 800:03d}-{2000 + counter % 8000:04d}-{2000 + counter * 7 % 8000:04d}-{20 + counter % 80:02d}'
    elif 'ê¸°ì—…' in bank:
        account = f'{200 + counter % 800:03d}-{200000 + counter % 800000:06d}-{20 + counter % 80:02d}-{200 + counter % 800:03d}'
    elif 'ì¹´ì¹´ì˜¤' in bank:
        account = f'{3333:04d}-{50 + counter % 50:02d}-{2000000 + counter * 17 % 8000000:07d}'
    elif 'í† ìŠ¤' in bank:
        account = f'{2000 + counter % 8000:04d}-{2000 + counter * 3 % 8000:04d}-{2000 + counter * 7 % 8000:04d}'
    else:
        account = f'{200 + counter % 800:03d}-{200000 + counter % 800000:06d}-{20000 + counter % 80000:05d}'

    # ì§€ì‚¬ ì „í™”ë²ˆí˜¸
    branch_middle = 4000 + (counter * 11) % 6000
    branch_last = 5000 + (counter * 17) % 5000

    # ì„¤ê³„ì‚¬ ì „í™”ë²ˆí˜¸
    designer_middle = 6000 + (counter * 23) % 4000
    designer_last = 7000 + (counter * 29) % 3000

    # ì„¤ê³„ì‚¬ ì´ë¦„
    designer_suffixes = ['ì„¤ê³„', 'ë§¤ë‹ˆì €', 'íŒ€ì¥', 'ê³¼ì¥', 'ëŒ€ë¦¬', 'ì£¼ì„', 'ì‹¤ì¥', 'ë¶€ì¥']
    designer_name = f'{name[0]}{designer_suffixes[counter % len(designer_suffixes)]}'

    # ë³´í—˜ ìƒí’ˆ ë° íšŒì‚¬ ì •ë³´
    insurance_products = [
        'ë¬´ë°°ë‹¹ KB 5.10.10 í”Œëœ',
        '(ë¬´) í•˜ë‚˜ë¡œ ë“ ë“ í•œ ë‚´ì¼',
        'ë¬´ë°°ë‹¹ ì‚¼ì„±í™”ì¬ ë“ ë“ í•œ ë¯¸ë˜',
        'ë¬´ë°°ë‹¹ ë©”ë¦¬ì¸  ì•ˆì‹¬ì¼€ì–´',
        'ë¬´ë°°ë‹¹ DBì†í•´ë³´í—˜ í”„ë¦¬ë¯¸ì—„',
        'ë¬´ë°°ë‹¹ í˜„ëŒ€í•´ìƒ í‰ìƒì¼€ì–´',
        'ë¬´ë°°ë‹¹ AIA ê±´ê°•í”Œëœ',
        'ë¬´ë°°ë‹¹ í‘¸ë¥´ë´ì…œ ê°€ì¡±ì‚¬ë‘',
        'ë¬´ë°°ë‹¹ êµë³´ìƒëª… ì•ˆì‹¬ë³´ì¥',
        'ë¬´ë°°ë‹¹ í•œí™”ìƒëª… ë“ ë“ í”Œëœ'
    ]

    insurance_companies = [
        'KBì†í•´ë³´í—˜', 'í•˜ë‚˜ìƒëª…', 'ì‚¼ì„±í™”ì¬', 'ë©”ë¦¬ì¸ í™”ì¬', 'DBì†í•´ë³´í—˜',
        'í˜„ëŒ€í•´ìƒ', 'AIAìƒëª…', 'í‘¸ë¥´ë´ì…œìƒëª…', 'êµë³´ìƒëª…', 'í•œí™”ìƒëª…'
    ]

    insurance_product = insurance_products[counter % len(insurance_products)]
    insurance_company = insurance_companies[counter % len(insurance_companies)]

    # ì§€ì‚¬ëª…
    branch_offices = [
        'ì„œìš¸ë³¸ì‚¬', 'ê°•ë‚¨ì§€ì‚¬', 'ê°•ë¶ì§€ì‚¬', 'ë¶„ë‹¹ì§€ì‚¬', 'ì¸ì²œì§€ì‚¬',
        'ê²½ê¸°ì§€ì‚¬', 'ë¶€ì‚°ì§€ì‚¬', 'ëŒ€êµ¬ì§€ì‚¬', 'ê´‘ì£¼ì§€ì‚¬', 'ëŒ€ì „ì§€ì‚¬'
    ]
    branch_office = branch_offices[counter % len(branch_offices)]

    return {
        'user_id': account_id,
        'name': name,
        'phone': f'010-{phone_middle:04d}-{phone_last:04d}',
        'idNumber': id_number,
        'bank': bank,
        'account': account,
        'salesperson': salesperson,
        'branch': f'010-{branch_middle:04d}-{branch_last:04d}',
        'designer': designer_name,
        'designer_phone': f'010-{designer_middle:04d}-{designer_last:04d}',
        'insurance_product': insurance_product,
        'insurance_company': insurance_company,
        'branch_office': branch_office
    }


def create_excel(filename, data_list, registration_month, save_dir):
    """Excel íŒŒì¼ ìƒì„±"""
    os.makedirs(save_dir, exist_ok=True)
    filepath = os.path.join(save_dir, filename)

    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = 'ìš©ì—­ì ëª…ë‹¨'

    headers = ['ìˆœë²ˆ', 'ë‚ ì§œ', 'ID', 'ì„±ëª…', 'ì—°ë½ì²˜', 'ì£¼ë¯¼ë²ˆí˜¸', 'ì€í–‰', 'ê³„ì¢Œë²ˆí˜¸', 'íŒë§¤ì¸', 'ì—°ë½ì²˜', 'ì„¤ê³„ì‚¬', 'ì—°ë½ì²˜', 'ë³´í—˜ìƒí’ˆëª…', 'ë³´í—˜íšŒì‚¬', 'ì§€ì‚¬']
    header_fill = PatternFill(start_color='366092', end_color='366092', fill_type='solid')
    header_font = Font(color='FFFFFF', bold=True)

    # í—¤ë” ì„¤ì •
    for col_num, header in enumerate(headers, 1):
        cell = ws.cell(row=1, column=col_num)
        cell.value = header
        cell.fill = header_fill
        cell.font = header_font
        cell.alignment = Alignment(horizontal='center', vertical='center')

    # í•´ë‹¹ ì›”ì˜ ì‹œì‘ ë‚ ì§œ ê³„ì‚°
    year, month = map(int, registration_month.split('-'))
    start_date = datetime(year, month, 1)

    # ë°ì´í„° ì…ë ¥
    for idx, person in enumerate(data_list):
        row_num = idx + 2
        # ë‚ ì§œëŠ” í•´ë‹¹ ì›”ì˜ 1ì¼ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ (3ëª…ì”© ê°™ì€ ë‚ )
        date_offset = idx // 3
        current_date = start_date + timedelta(days=date_offset)
        date_str = current_date.strftime('%Y-%m-%d')

        ws.cell(row=row_num, column=1).value = idx + 1
        ws.cell(row=row_num, column=2).value = date_str
        ws.cell(row=row_num, column=3).value = person['user_id']
        ws.cell(row=row_num, column=4).value = person['name']
        ws.cell(row=row_num, column=5).value = person['phone']
        ws.cell(row=row_num, column=6).value = person['idNumber']
        ws.cell(row=row_num, column=7).value = person['bank']
        ws.cell(row=row_num, column=8).value = person['account']
        ws.cell(row=row_num, column=9).value = person['salesperson']
        ws.cell(row=row_num, column=10).value = person['branch']
        ws.cell(row=row_num, column=11).value = person['designer']
        ws.cell(row=row_num, column=12).value = person['designer_phone']
        ws.cell(row=row_num, column=13).value = person['insurance_product']
        ws.cell(row=row_num, column=14).value = person['insurance_company']
        ws.cell(row=row_num, column=15).value = person['branch_office']

    # ì»¬ëŸ¼ ë„ˆë¹„ ìë™ ì¡°ì •
    for col in ws.columns:
        max_length = 0
        column = col[0].column_letter
        for cell in col:
            try:
                if len(str(cell.value)) > max_length:
                    max_length = len(str(cell.value))
            except:
                pass
        adjusted_width = min((max_length + 2) * 1.2, 50)
        ws.column_dimensions[column].width = adjusted_width

    wb.save(filepath)
    print(f'âœ… {filepath} ìƒì„± ì™„ë£Œ ({len(data_list)}ëª…)')


def process_november_data():
    """11ì›” ë°ì´í„° ì²˜ë¦¬ - 10ì›” ë“±ë¡ìë¥¼ íŒë§¤ì¸ìœ¼ë¡œ ì—°ê²° (ìë¦¬ê°€ ë¹„ì–´ìˆì„ ê°€ëŠ¥ì„± ë†’ìŒ)"""
    result = []
    counter = 200  # ê¸°ì¡´ ë°ì´í„°ì™€ êµ¬ë¶„ë˜ëŠ” ì¹´ìš´í„° ì‹œì‘

    # â­ 10ì›” ë“±ë¡ìë§Œ íŒë§¤ì¸ìœ¼ë¡œ ì‚¬ìš© (íŠ¸ë¦¬ì— ìë¦¬ê°€ ë¹„ì–´ìˆì„ ê°€ëŠ¥ì„± ë†’ìŒ)
    # ê° íŒë§¤ì¸ë‹¹ ìµœëŒ€ 2ëª…ë§Œ ì—°ê²° (ì´ì§„ íŠ¸ë¦¬)
    october_parents = [
        'ê¹€íƒœí¬', 'ì •ìš°ì„±', 'ì •ìš°ì„±2', 'ì •ìš°ì„±3', 'ì •ìš°ì„±4', 'ì •ìš°ì„±5',
        'ì†ì˜ˆì§„', 'ì†ì˜ˆì§„2', 'í˜„ë¹ˆ', 'í˜„ë¹ˆ2', 'í˜„ë¹ˆ3', 'í˜„ë¹ˆ4',
        'ì´ë³‘í—Œ', 'ì†¡í˜œêµ', 'ì†¡í˜œêµ2', 'ì†¡í˜œêµ3',
        'ê°•ë™ì›', 'ê°•ë™ì›2', 'ê°•ë™ì›3', 'ê°•ë™ì›4', 'ê°•ë™ì›5', 'ê°•ë™ì›6',
        'ì „ë„ì—°', 'ì „ë„ì—°2', 'í•˜ì •ìš°', 'í•˜ì •ìš°2', 'í•˜ì •ìš°3', 'í•˜ì •ìš°4',
        'ê¹€í˜œìˆ˜', 'ì¡°ì¸ì„±', 'ì¡°ì¸ì„±2', 'ì¡°ì¸ì„±3',
        'ì†¡ê°•í˜¸', 'ì†¡ê°•í˜¸2', 'ì†¡ê°•í˜¸3', 'ì†¡ê°•í˜¸4', 'ì†¡ê°•í˜¸5',
        'ì´ì •ì¬', 'ì´ì •ì¬2', 'ê³µìœ ',
        'ê¹€ìˆ˜í˜„', 'ê¹€ìˆ˜í˜„2', 'ê¹€ìˆ˜í˜„3', 'ê¹€ìˆ˜í˜„4', 'ê¹€ìˆ˜í˜„5', 'ê¹€ìˆ˜í˜„6', 'ê¹€ìˆ˜í˜„7',
        'ë°•ì„œì¤€', 'ë°•ì„œì¤€2', 'ë°•ì„œì¤€3', 'ì´ë¯¼í˜¸', 'ì´ë¯¼í˜¸2',
        'ê¹€ì§€ì›', 'ê¹€ì§€ì›2', 'ê¹€ì§€ì›3', 'ê¹€ì§€ì›4',
        'ë°•ë³´ì˜', 'í•œíš¨ì£¼', 'í•œíš¨ì£¼2', 'í•œíš¨ì£¼3', 'í•œíš¨ì£¼4', 'í•œíš¨ì£¼5',
        'ìˆ˜ì§€', 'ìˆ˜ì§€2', 'ì•„ì´ìœ ', 'ì•„ì´ìœ 2', 'ì•„ì´ìœ 3',
        'ê¹€ê³ ì€', 'ê¹€ê³ ì€2', 'ê¹€ê³ ì€3', 'ê¹€ê³ ì€4',
        'ë°•ì‹ í˜œ', 'ì „ì†Œë¯¼', 'ì „ì†Œë¯¼2', 'ì „ì†Œë¯¼3', 'ì „ì†Œë¯¼4', 'ì „ì†Œë¯¼5', 'ì „ì†Œë¯¼6',
        'ê¹€ë‹¤ë¯¸', 'ê¹€ë‹¤ë¯¸2', 'ì´ì„±ê²½', 'ì´ì„±ê²½2', 'ì´ì„±ê²½3',
        'í•œì†Œí¬', 'í•œì†Œí¬2', 'í•œì†Œí¬3', 'í•œì†Œí¬4',
        'ì •í˜¸ì—°', 'ê¹€ì„¸ì •', 'ê¹€ì„¸ì •2', 'ê¹€ì„¸ì •3', 'ê¹€ì„¸ì •4', 'ê¹€ì„¸ì •5',
    ]

    parent_index = 0

    for account_id, names in NOVEMBER:
        for name in names:
            # íŒë§¤ì¸ì€ 10ì›” ë“±ë¡ì ì¤‘ì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ ì„ íƒ
            salesperson = october_parents[parent_index % len(october_parents)]
            parent_index += 1

            person_data = generate_person_data(name, counter, account_id, salesperson)
            result.append(person_data)
            counter += 1

    return result


def main():
    print('ğŸš€ 11ì›” í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì‹œì‘...\n')

    # ë°ì´í„° ìˆ˜ í™•ì¸
    november_count = sum(len(names) for _, names in NOVEMBER)
    print(f'ğŸ“Š 11ì›” ë°ì´í„°: {november_count}ëª… (ID: {len(NOVEMBER)}ê°œ)')
    print(f'ğŸ“Š ê¸°ì¡´ ì‚¬ìš©ì: {len(EXISTING_USERS)}ëª… (íŒë§¤ì¸ìœ¼ë¡œ ì‚¬ìš©)')
    print()

    # 11ì›” ë°ì´í„° ì²˜ë¦¬
    november_data = process_november_data()
    print(f'âœ… 11ì›” ë°ì´í„° ì²˜ë¦¬ ì™„ë£Œ: {len(november_data)}ëª…\n')

    # Excel íŒŒì¼ ìƒì„±
    save_dir = os.path.join(os.path.dirname(__file__), '..', 'test-data', 'verify')
    create_excel('11ì›”_ìš©ì—­ìëª…ë‹¨_ê°„ë‹¨.xlsx', november_data, '2025-11', save_dir)

    print('\nğŸ“Š ì „ì²´ ìš”ì•½:')
    print(f'  ê¸°ì¡´ (7-10ì›”): ì•½ 160ëª…')
    print(f'  11ì›” ì¶”ê°€: {len(november_data)}ëª…')
    print(f'  ì˜ˆìƒ ì´ê³„: ì•½ {160 + len(november_data)}ëª…')
    print('\nâœ… 11ì›” í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì™„ë£Œ!')


if __name__ == '__main__':
    main()
