#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ì›”ë³„ ìš©ì—­ì ë“±ë¡ í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- íŒë§¤ì¸ì€ ë°˜ë“œì‹œ ì´ì „ì— ë“±ë¡ëœ ì‚¬ëŒì´ì–´ì•¼ í•¨ (ì´ì§„ íŠ¸ë¦¬ ê·œì¹™)
"""

import openpyxl
from openpyxl.styles import Font, Alignment, PatternFill, Border, Side
from datetime import datetime
from collections import defaultdict
import os

# ìŠ¤íƒ€ì¼ ì •ì˜
header_font = Font(name='ë§‘ì€ ê³ ë”•', size=11, bold=True, color='FFFFFF')
header_fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')
data_font = Font(name='ë§‘ì€ ê³ ë”•', size=10)
center_alignment = Alignment(horizontal='center', vertical='center')
left_alignment = Alignment(horizontal='left', vertical='center')
thin_border = Border(
    left=Side(style='thin', color='D3D3D3'),
    right=Side(style='thin', color='D3D3D3'),
    top=Side(style='thin', color='D3D3D3'),
    bottom=Side(style='thin', color='D3D3D3')
)

# ë³´í—˜ ìƒí’ˆ ì •ë³´ (5ê°œ ìˆœí™˜)
insurance_products = [
    ('ì‚¼ì„±í™”ì¬ ì‹¤ì†ë³´í—˜', 'ì‚¼ì„±í™”ì¬', 'ê°•ë‚¨ì§€ì '),
    ('í˜„ëŒ€í•´ìƒ ì•”ë³´í—˜', 'í˜„ëŒ€í•´ìƒ', 'ì„œì´ˆì§€ì '),
    ('DBì†í•´ë³´í—˜ ìš´ì „ìë³´í—˜', 'DBì†í•´ë³´í—˜', 'ì†¡íŒŒì§€ì '),
    ('KBì†í•´ë³´í—˜ ì—¬í–‰ìë³´í—˜', 'KBì†í•´ë³´í—˜', 'ê´‘í™”ë¬¸ì§€ì '),
    ('ë©”ë¦¬ì¸ í™”ì¬ ê±´ê°•ë³´í—˜', 'ë©”ë¦¬ì¸ í™”ì¬', 'ì¢…ë¡œì§€ì '),
]

def create_excel(filename, data, month_name):
    """ì—‘ì…€ íŒŒì¼ ìƒì„±"""
    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = f"{month_name} ìš©ì—­ìëª…ë‹¨"

    # í—¤ë” (15 columns)
    headers = ['ìˆœë²ˆ', 'ë‚ ì§œ', 'ID', 'ì„±ëª…', 'ì—°ë½ì²˜', 'ì£¼ë¯¼ë²ˆí˜¸', 'ì€í–‰', 'ê³„ì¢Œë²ˆí˜¸',
               'íŒë§¤ì¸', 'ì—°ë½ì²˜', 'ì„¤ê³„ì‚¬', 'ì—°ë½ì²˜', 'ë³´í—˜ìƒí’ˆëª…', 'ë³´í—˜íšŒì‚¬', 'ì§€ì‚¬']

    for col, header in enumerate(headers, 1):
        cell = ws.cell(row=1, column=col, value=header)
        cell.font = header_font
        cell.fill = header_fill
        cell.alignment = center_alignment
        cell.border = thin_border

    # ì—´ ë„ˆë¹„ ì„¤ì •
    ws.column_dimensions['A'].width = 8   # ìˆœë²ˆ
    ws.column_dimensions['B'].width = 12  # ë‚ ì§œ
    ws.column_dimensions['C'].width = 12  # ID
    ws.column_dimensions['D'].width = 12  # ì„±ëª…
    ws.column_dimensions['E'].width = 14  # ì—°ë½ì²˜
    ws.column_dimensions['F'].width = 16  # ì£¼ë¯¼ë²ˆí˜¸
    ws.column_dimensions['G'].width = 12  # ì€í–‰
    ws.column_dimensions['H'].width = 16  # ê³„ì¢Œë²ˆí˜¸
    ws.column_dimensions['I'].width = 12  # íŒë§¤ì¸
    ws.column_dimensions['J'].width = 14  # ì—°ë½ì²˜
    ws.column_dimensions['K'].width = 12  # ì„¤ê³„ì‚¬
    ws.column_dimensions['L'].width = 14  # ì—°ë½ì²˜
    ws.column_dimensions['M'].width = 18  # ë³´í—˜ìƒí’ˆëª…
    ws.column_dimensions['N'].width = 14  # ë³´í—˜íšŒì‚¬
    ws.column_dimensions['O'].width = 12  # ì§€ì‚¬

    # ì´ë¦„ë³„ ì¹´ìš´íŠ¸ (ID ì¤‘ë³µ ì‹œ ì„±ëª…ì— ë²ˆí˜¸ ë¶™ì´ê¸°)
    name_count = defaultdict(int)

    # ë°ì´í„° ì…ë ¥
    for idx, row in enumerate(data, 1):
        user_id, name, phone, resident_num, bank, account, salesperson, salesperson_phone, agent, agent_phone = row

        # ì´ë¦„ ì¤‘ë³µ ì²˜ë¦¬
        name_count[user_id] += 1
        count = name_count[user_id]

        if count == 1:
            final_name = name
        else:
            final_name = f"{name}{count}"  # ë°•ì² ìˆ˜, ë°•ì² ìˆ˜2, ë°•ì² ìˆ˜3

        # ë³´í—˜ ìƒí’ˆ (ìˆœí™˜)
        insurance = insurance_products[idx % len(insurance_products)]

        row_num = idx + 1
        cells = [
            (1, idx, center_alignment),                          # ìˆœë²ˆ
            (2, month_name, center_alignment),                   # ë‚ ì§œ
            (3, user_id, center_alignment),                      # ID
            (4, final_name, center_alignment),                   # ì„±ëª…
            (5, phone, center_alignment),                        # ì—°ë½ì²˜
            (6, resident_num, center_alignment),                 # ì£¼ë¯¼ë²ˆí˜¸
            (7, bank, center_alignment),                         # ì€í–‰
            (8, account, center_alignment),                      # ê³„ì¢Œë²ˆí˜¸
            (9, salesperson, center_alignment),                  # íŒë§¤ì¸
            (10, salesperson_phone, center_alignment),           # ì—°ë½ì²˜
            (11, agent, center_alignment),                       # ì„¤ê³„ì‚¬
            (12, agent_phone, center_alignment),                 # ì—°ë½ì²˜
            (13, insurance[0], left_alignment),                  # ë³´í—˜ìƒí’ˆëª…
            (14, insurance[1], center_alignment),                # ë³´í—˜íšŒì‚¬
            (15, insurance[2], center_alignment),                # ì§€ì‚¬
        ]

        for col, value, alignment in cells:
            cell = ws.cell(row=row_num + 1, column=col, value=value)
            cell.font = data_font
            cell.alignment = alignment
            cell.border = thin_border

    # íŒŒì¼ ì €ì¥
    output_dir = '/home/doowon/project/my/nanumpay/test-data'
    os.makedirs(output_dir, exist_ok=True)
    filepath = os.path.join(output_dir, filename)
    wb.save(filepath)
    print(f'âœ… {filename} ìƒì„± ì™„ë£Œ ({len(data)}ëª…)')

def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""

    # ===== 7ì›”_ê°„ë‹¨ (3ëª…) - ë£¨íŠ¸ =====
    july_simple = [
        # ID, ì´ë¦„, ì—°ë½ì²˜, ì£¼ë¯¼ë²ˆí˜¸, ì€í–‰, ê³„ì¢Œë²ˆí˜¸, íŒë§¤ì¸, íŒë§¤ì¸ì—°ë½ì²˜, ì„¤ê³„ì‚¬, ì„¤ê³„ì‚¬ì—°ë½ì²˜
        ('boss', 'ì‚¬ì¥ë‹˜', '010-1111-1111', '800101-1234567', 'êµ­ë¯¼ì€í–‰', '123-456-789012', '', '', 'ê¹€ì„¤ê³„', '010-9991-0001'),
        ('kim001', 'ê¹€ì˜ìˆ˜', '010-2222-2222', '850202-1234567', 'ì‹ í•œì€í–‰', '234-567-890123', 'ì‚¬ì¥ë‹˜', '010-1111-1111', 'ì´ì„¤ê³„', '010-9992-0002'),
        ('lee001', 'ì´ë¯¸ì˜', '010-3333-3333', '900303-2234567', 'ìš°ë¦¬ì€í–‰', '345-678-901234', 'ì‚¬ì¥ë‹˜', '010-1111-1111', 'ë°•ì„¤ê³„', '010-9993-0003'),
    ]

    # ===== 7ì›”_ì¶”ê°€ (7ëª…) - 2ë‹¨ê³„ê¹Œì§€ =====
    july_add = [
        # ê¹€ì˜ìˆ˜ ë°‘ 2ëª…
        ('park001', 'ë°•ì² ìˆ˜', '010-4444-4444', '880404-1234567', 'í•˜ë‚˜ì€í–‰', '456-789-012345', 'ê¹€ì˜ìˆ˜', '010-2222-2222', 'ìµœì„¤ê³„', '010-9994-0004'),
        ('park001', 'ë°•ì² ìˆ˜', '010-4445-4445', '880405-1234567', 'í•˜ë‚˜ì€í–‰', '456-789-012346', 'ê¹€ì˜ìˆ˜', '010-2222-2222', 'ì •ì„¤ê³„', '010-9995-0005'),
        # ì´ë¯¸ì˜ ë°‘ 2ëª…
        ('park001', 'ë°•ì² ìˆ˜', '010-4446-4446', '880406-1234567', 'í•˜ë‚˜ì€í–‰', '456-789-012347', 'ì´ë¯¸ì˜', '010-3333-3333', 'ê°•ì„¤ê³„', '010-9996-0006'),
        ('kang001', 'ê°•ë¯¼ì§€', '010-5555-5555', '920505-2234567', 'KBêµ­ë¯¼ì€í–‰', '567-890-123456', 'ì´ë¯¸ì˜', '010-3333-3333', 'ìœ¤ì„¤ê³„', '010-9997-0007'),
        # ë°•ì² ìˆ˜(ì²«ë²ˆì§¸) ë°‘ 2ëª…
        ('lee002', 'ì´ìˆœì‹ ', '010-6666-6666', '700606-1234567', 'ë†í˜‘ì€í–‰', '678-901-234567', 'ë°•ì² ìˆ˜', '010-4444-4444', 'ì„œì„¤ê³„', '010-9998-0008'),
        ('kim002', 'ê¹€ìœ ì‹ ', '010-7777-7777', '750707-1234567', 'ê¸°ì—…ì€í–‰', '789-012-345678', 'ë°•ì² ìˆ˜', '010-4444-4444', 'ë…¸ì„¤ê³„', '010-9999-0009'),
        # ë°•ì² ìˆ˜2(ë‘ë²ˆì§¸) ë°‘ 1ëª…
        ('jo001', 'ì¡°ë™í˜„', '010-8888-8888', '930808-1234567', 'ì‹ í˜‘', '890-123-456789', 'ë°•ì² ìˆ˜2', '010-4445-4445', 'êµ¬ì„¤ê³„', '010-9990-0010'),
    ]

    # ===== 8ì›”_ê°„ë‹¨ (15ëª…) - 3ë‹¨ê³„ ì±„ìš°ê¸° =====
    # ê¸°ì¡´ 10ëª… + ì‹ ê·œ 15ëª… = ì´ 25ëª…
    august_simple = []
    base_names = ['í•œì˜ˆì§„', 'í™©ë¯¼ì •', 'ì‹ ìœ¤ë³µ', 'ì •ì„ ', 'ë°•ì§€ì›']

    # ë°•ì² ìˆ˜3(ì„¸ë²ˆì§¸) ë°‘ 2ëª…
    august_simple.append(('han001', 'í•œì˜ˆì§„', '010-5001-5001', '910101-2234567', 'êµ­ë¯¼ì€í–‰', '100-200-300001', 'ë°•ì² ìˆ˜3', '010-4446-4446', 'ê°€ì„¤ê³„', '010-8001-0001'))
    august_simple.append(('han001', 'í•œì˜ˆì§„', '010-5002-5002', '910102-2234567', 'êµ­ë¯¼ì€í–‰', '100-200-300002', 'ë°•ì² ìˆ˜3', '010-4446-4446', 'ë‚˜ì„¤ê³„', '010-8002-0002'))

    # ê°•ë¯¼ì§€ ë°‘ 2ëª…
    august_simple.append(('han001', 'í•œì˜ˆì§„', '010-5003-5003', '910103-2234567', 'êµ­ë¯¼ì€í–‰', '100-200-300003', 'ê°•ë¯¼ì§€', '010-5555-5555', 'ë‹¤ì„¤ê³„', '010-8003-0003'))
    august_simple.append(('hwang001', 'í™©ë¯¼ì •', '010-5004-5004', '920201-2234567', 'ì‹ í•œì€í–‰', '200-300-400001', 'ê°•ë¯¼ì§€', '010-5555-5555', 'ë¼ì„¤ê³„', '010-8004-0004'))

    # ì´ìˆœì‹  ë°‘ 2ëª…
    august_simple.append(('hwang001', 'í™©ë¯¼ì •', '010-5005-5005', '920202-2234567', 'ì‹ í•œì€í–‰', '200-300-400002', 'ì´ìˆœì‹ ', '010-6666-6666', 'ë§ˆì„¤ê³„', '010-8005-0005'))
    august_simple.append(('hwang001', 'í™©ë¯¼ì •', '010-5006-5006', '920203-2234567', 'ì‹ í•œì€í–‰', '200-300-400003', 'ì´ìˆœì‹ ', '010-6666-6666', 'ë°”ì„¤ê³„', '010-8006-0006'))

    # ê¹€ìœ ì‹  ë°‘ 2ëª…
    august_simple.append(('shin001', 'ì‹ ìœ¤ë³µ', '010-5007-5007', '930301-2234567', 'ìš°ë¦¬ì€í–‰', '300-400-500001', 'ê¹€ìœ ì‹ ', '010-7777-7777', 'ì‚¬ì„¤ê³„', '010-8007-0007'))
    august_simple.append(('shin001', 'ì‹ ìœ¤ë³µ', '010-5008-5008', '930302-2234567', 'ìš°ë¦¬ì€í–‰', '300-400-500002', 'ê¹€ìœ ì‹ ', '010-7777-7777', 'ì•„ì„¤ê³„', '010-8008-0008'))

    # ì¡°ë™í˜„ ë°‘ 2ëª…
    august_simple.append(('shin001', 'ì‹ ìœ¤ë³µ', '010-5009-5009', '930303-2234567', 'ìš°ë¦¬ì€í–‰', '300-400-500003', 'ì¡°ë™í˜„', '010-8888-8888', 'ìì„¤ê³„', '010-8009-0009'))
    august_simple.append(('jung001', 'ì •ì„ ', '010-5010-5010', '940401-1234567', 'í•˜ë‚˜ì€í–‰', '400-500-600001', 'ì¡°ë™í˜„', '010-8888-8888', 'ì°¨ì„¤ê³„', '010-8010-0010'))

    # í•œì˜ˆì§„(ì²«ë²ˆì§¸) ë°‘ 2ëª…
    august_simple.append(('jung001', 'ì •ì„ ', '010-5011-5011', '940402-1234567', 'í•˜ë‚˜ì€í–‰', '400-500-600002', 'í•œì˜ˆì§„', '010-5001-5001', 'ì¹´ì„¤ê³„', '010-8011-0011'))
    august_simple.append(('jung001', 'ì •ì„ ', '010-5012-5012', '940403-1234567', 'í•˜ë‚˜ì€í–‰', '400-500-600003', 'í•œì˜ˆì§„', '010-5001-5001', 'íƒ€ì„¤ê³„', '010-8012-0012'))

    # í•œì˜ˆì§„2(ë‘ë²ˆì§¸) ë°‘ 2ëª…
    august_simple.append(('park002', 'ë°•ì§€ì›', '010-5013-5013', '950501-2234567', 'KBêµ­ë¯¼ì€í–‰', '500-600-700001', 'í•œì˜ˆì§„2', '010-5002-5002', 'íŒŒì„¤ê³„', '010-8013-0013'))
    august_simple.append(('park002', 'ë°•ì§€ì›', '010-5014-5014', '950502-2234567', 'KBêµ­ë¯¼ì€í–‰', '500-600-700002', 'í•œì˜ˆì§„2', '010-5002-5002', 'í•˜ì„¤ê³„', '010-8014-0014'))

    # í•œì˜ˆì§„3(ì„¸ë²ˆì§¸) ë°‘ 1ëª…
    august_simple.append(('park002', 'ë°•ì§€ì›', '010-5015-5015', '950503-2234567', 'KBêµ­ë¯¼ì€í–‰', '500-600-700003', 'í•œì˜ˆì§„3', '010-5003-5003', 'ê°€ì„¤ê³„', '010-8015-0015'))

    # ===== 9ì›”_ê°„ë‹¨ (45ëª…) - 4ë‹¨ê³„ ëŒ€ë¶€ë¶„ ì±„ìš°ê¸° =====
    # ê¸°ì¡´ 25ëª… + ì‹ ê·œ 45ëª… = ì´ 70ëª…
    september_simple = []
    sep_names = ['ìµœë¯¼ìˆ˜', 'ì†¡ê°€ì¸', 'ë¥˜í˜„ì§„', 'ì•ˆì •í™˜', 'ë°°ìš©ì¤€', 'ì „ì§€í˜„', 'ê³ ì†Œì˜']

    # 8ì›” 15ëª… ê°ê° ë°‘ì— 2~3ëª…ì”© ë°°ì¹˜ (ì´ 45ëª…)
    # ê°„ë‹¨í•˜ê²Œ ìˆœí™˜ ë°°ì •
    parent_names = [
        'í™©ë¯¼ì •', 'í™©ë¯¼ì •2', 'í™©ë¯¼ì •3', 'ì‹ ìœ¤ë³µ', 'ì‹ ìœ¤ë³µ2', 'ì‹ ìœ¤ë³µ3',
        'ì •ì„ ', 'ì •ì„ 2', 'ì •ì„ 3', 'ë°•ì§€ì›', 'ë°•ì§€ì›2', 'ë°•ì§€ì›3',
        # ë‚˜ë¨¸ì§€ëŠ” í•œì˜ˆì§„ë¶€í„° ë‹¤ì‹œ
        'í•œì˜ˆì§„', 'í•œì˜ˆì§„2', 'í•œì˜ˆì§„3'
    ]

    for i in range(45):
        name_base = sep_names[i % len(sep_names)]
        parent_name = parent_names[i % len(parent_names)]
        september_simple.append((
            f'sep{i+1:03d}',
            name_base,
            f'010-6{i+1:03d}-{i+1:04d}',
            f'{90 + (i % 10):02d}{(i % 12) + 1:02d}{(i % 28) + 1:02d}-{1 + (i % 2)}234567',
            ['êµ­ë¯¼ì€í–‰', 'ì‹ í•œì€í–‰', 'ìš°ë¦¬ì€í–‰', 'í•˜ë‚˜ì€í–‰', 'KBêµ­ë¯¼ì€í–‰'][i % 5],
            f'{600 + i:03d}-{700 + i:03d}-{800000 + i:06d}',
            parent_name,
            f'010-5{((i % 15) + 1):03d}-5{((i % 15) + 1):03d}',
            f'{name_base[:1]}ì„¤ê³„',
            f'010-9{i+1:03d}-{i+1:04d}'
        ))

    # ===== 10ì›”_ê°„ë‹¨ (90ëª…) - 5ë‹¨ê³„ ì±„ìš°ê¸° =====
    # ê¸°ì¡´ 70ëª… + ì‹ ê·œ 90ëª… = ì´ 160ëª…
    october_simple = []
    oct_names = ['ê¹€ë¯¼ì¬', 'ì´ê°•ì¸', 'ì†í¥ë¯¼', 'í™©í¬ì°¬', 'ì´ì¬ì„±', 'í™©ì¸ë²”', 'ê¹€ì˜ê¶Œ', 'ì¡°í˜„ìš°', 'ê¹€ìŠ¹ê·œ', 'í™ì² ']

    # 9ì›” 45ëª… ê°ê° ë°‘ì— 2ëª…ì”© ë°°ì¹˜ (ì´ 90ëª…)
    for i in range(90):
        name_base = oct_names[i % len(oct_names)]
        parent_idx = i % 45
        parent_name = sep_names[parent_idx % len(sep_names)]
        if parent_idx > 0 and parent_idx % 7 == 0:
            parent_name = f"{parent_name}{(parent_idx // 7) + 1}"

        october_simple.append((
            f'oct{i+1:03d}',
            name_base,
            f'010-7{i+1:03d}-{i+1:04d}',
            f'{85 + (i % 15):02d}{(i % 12) + 1:02d}{(i % 28) + 1:02d}-{1 + (i % 2)}234567',
            ['êµ­ë¯¼ì€í–‰', 'ì‹ í•œì€í–‰', 'ìš°ë¦¬ì€í–‰', 'í•˜ë‚˜ì€í–‰', 'KBêµ­ë¯¼ì€í–‰', 'ë†í˜‘ì€í–‰'][i % 6],
            f'{700 + i:03d}-{800 + i:03d}-{900000 + i:06d}',
            parent_name,
            f'010-6{(parent_idx + 1):03d}-{(parent_idx + 1):04d}',
            f'{name_base[:1]}ì„¤ê³„',
            f'010-9{100 + i:03d}-{i+1:04d}'
        ))

    # íŒŒì¼ ìƒì„±
    create_excel('7ì›”_ìš©ì—­ìëª…ë‹¨_ê°„ë‹¨.xlsx', july_simple, '2025-07')
    create_excel('7ì›”_ìš©ì—­ìëª…ë‹¨_ì¶”ê°€.xlsx', july_add, '2025-07')
    create_excel('8ì›”_ìš©ì—­ìëª…ë‹¨_ê°„ë‹¨.xlsx', august_simple, '2025-08')
    create_excel('9ì›”_ìš©ì—­ìëª…ë‹¨_ê°„ë‹¨.xlsx', september_simple, '2025-09')
    create_excel('10ì›”_ìš©ì—­ìëª…ë‹¨_ê°„ë‹¨.xlsx', october_simple, '2025-10')

    print('\nğŸ“Š ì „ì²´ ìš”ì•½:')
    print(f'  7ì›” ê°„ë‹¨: 3ëª… (ëˆ„ì  3ëª…)')
    print(f'  7ì›” ì¶”ê°€: 7ëª… (ëˆ„ì  10ëª…)')
    print(f'  8ì›”: 15ëª… (ëˆ„ì  25ëª…)')
    print(f'  9ì›”: 45ëª… (ëˆ„ì  70ëª…)')
    print(f'  10ì›”: 90ëª… (ëˆ„ì  160ëª…)')
    print('\nâœ… ëª¨ë“  íŒŒì¼ ìƒì„± ì™„ë£Œ!')
    print('âš ï¸  íŒë§¤ì¸ì€ ëª¨ë‘ ì´ì „ì— ë“±ë¡ëœ ì‚¬ëŒìœ¼ë¡œ ì„¤ì •ë¨')

if __name__ == '__main__':
    main()
